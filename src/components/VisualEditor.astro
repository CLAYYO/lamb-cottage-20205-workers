---
// Visual Editor Component for Admin Interface
const { type, sectionId, fieldPath, content, placeholder, className, min, max, step } = Astro.props;

// Generate unique ID for this editor instance
const editorId = `editor-${sectionId}-${fieldPath ? fieldPath.replace(/\./g, '-') : 'field'}-${Math.random().toString(36).substr(2, 9)}`;
---

{type === 'image' && (
  <div class="image-editor-container">
    {content ? (
      <img 
        id={editorId}
        src={content} 
        alt="Editable image"
        class={`editable-image ${className || ''}`}
        data-editable="true"
        data-section={sectionId}
        data-field={fieldPath}
        style="max-width: 100%; height: auto; min-height: 200px; border: 2px dashed #d1d5db; border-radius: 8px; cursor: pointer;"
      />
    ) : (
      <div 
        id={editorId}
        class={`image-placeholder ${className || ''}`}
        data-editable="true"
        data-section={sectionId}
        data-field={fieldPath}
        style="min-height: 200px; border: 2px dashed #d1d5db; border-radius: 8px; display: flex; align-items: center; justify-content: center; background: #f9fafb; cursor: pointer; color: #6b7280;"
      >
        <div style="text-align: center;">
          <div style="font-size: 48px; margin-bottom: 8px;">ðŸ“·</div>
          <div>Click to upload image</div>
          <div style="font-size: 12px; margin-top: 4px;">Recommended size: 1920x600px</div>
        </div>
      </div>
    )}
  </div>
)}

{type === 'text' && (
  <input 
    id={editorId}
    type="text" 
    value={content || ''}
    placeholder={placeholder || ''}
    class={`editable-text ${className || ''}`}
    data-editable="true"
    data-section={sectionId}
    data-field={fieldPath}
    style="width: 100%; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;"
  />
)}

{type === 'textarea' && (
  <textarea 
    id={editorId}
    placeholder={placeholder || ''}
    class={`editable-textarea ${className || ''}`}
    data-editable="true"
    data-section={sectionId}
    data-field={fieldPath}
    style="width: 100%; min-height: 100px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; resize: vertical;"
  >{content || ''}</textarea>
)}

{type === 'rich' && (
  <div 
    id={editorId}
    class={`editable-rich ${className || ''}`}
    data-editable="true"
    data-section={sectionId}
    data-field={fieldPath}
    style="min-height: 120px; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white;"
  >
    {content || placeholder || 'Click to edit content...'}
  </div>
)}

{type === 'range' && (
  <input 
    id={editorId}
    type="range" 
    value={content || 0.4}
    min={min || 0}
    max={max || 1}
    step={step || 0.1}
    class={`editable-range ${className || ''}`}
    data-editable="true"
    data-section={sectionId}
    data-field={fieldPath}
    style="width: 100%;"
  />
)}

<!-- VisualEditor script removed - BackgroundImageUpload components handle their own functionality -->

<style>
  .edit-btn {
    position: absolute;
    top: -10px;
    right: -10px;
    background: #3b82f6;
    color: white;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    cursor: pointer;
    font-size: 12px;
    z-index: 1000;
    opacity: 1;
    transition: opacity 0.2s;
    display: block !important;
    visibility: visible !important;
  }
  
  [data-editable]:hover .edit-btn {
    opacity: 1;
  }
  
  [data-editable] {
    position: relative;
  }
  
  .edit-textarea {
    width: 100%;
    min-height: 100px;
    padding: 8px;
    border: 2px solid #3b82f6;
    border-radius: 4px;
    font-family: inherit;
    font-size: inherit;
    resize: vertical;
  }
  
  .edit-buttons {
    margin-top: 8px;
    display: flex;
    gap: 8px;
  }
  
  .save-btn, .cancel-btn, .change-image-btn, .delete-image-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }
  
  .save-btn {
    background: #10b981;
    color: white;
  }
  
  .cancel-btn {
    background: #6b7280;
    color: white;
  }
  
  .change-image-btn {
    background: #3b82f6;
    color: white;
  }
  
  .delete-image-btn {
    background: #ef4444;
    color: white;
  }
  
  .image-edit-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    z-index: 20;
  }
</style>